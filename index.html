<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKYWORLD LOOTS | 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <!-- Three.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        :root {
            --neon-pink: #ff00ff;
            --neon-blue: #00ffff;
            --neon-purple: #bc13fe;
            --bg-color: #050505;
            --text-color: #ffffff;
            --terminal-green: #0f0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Orbitron', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* --- 1. CUSTOM SCROLLBAR --- */
        ::-webkit-scrollbar {
            width: 10px;
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--neon-purple);
            border: 1px solid var(--neon-blue);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink);
        }
        ::-webkit-scrollbar-corner {
            background: #000;
        }

        /* --- 2. BOOT SCREEN STYLES --- */
        #boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Orbitron', monospace;
            color: var(--terminal-green);
            transition: opacity 0.8s ease-out;
            pointer-events: none; /* Prevents blocking clicks during fade out */
        }

        .boot-text {
            font-size: 1.2rem;
            line-height: 1.8;
            text-shadow: 0 0 10px var(--terminal-green);
            text-align: left;
        }

        /* Background grid effect */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            z-index: -1;
        }

        /* 3D Canvas Layer */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Behind content */
            opacity: 0.6;
        }

        /* Scanline Effect */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 999;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        /* Header & Nav */
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid var(--neon-purple);
            padding-bottom: 20px;
            box-shadow: 0 0 15px var(--neon-purple);
            background: rgba(5, 5, 5, 0.85); /* Semi-transparent */
            padding-top: 20px;
        }

        h1 {
            font-family: 'Press Start 2P', cursive;
            color: var(--neon-blue);
            text-shadow: 2px 2px var(--neon-pink), 0 0 20px var(--neon-blue);
            font-size: 2.5rem;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .subtitle {
            color: var(--neon-pink);
            letter-spacing: 3px;
            font-size: 1.2rem;
        }

        nav {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-btn {
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            text-decoration: none;
            transition: 0.3s;
            text-transform: uppercase;
        }

        .nav-btn:hover {
            background: var(--neon-blue);
            color: var(--bg-color);
            box-shadow: 0 0 15px var(--neon-blue);
        }

        /* Itinerary Section */
        .itinerary-box {
            border: 2px solid var(--neon-pink);
            padding: 20px;
            margin: 30px 0;
            box-shadow: 0 0 10px var(--neon-pink), inset 0 0 20px rgba(255, 0, 255, 0.2);
            background: rgba(0, 0, 0, 0.7); /* See-through to show 3D effects */
            backdrop-filter: blur(5px);
        }

        .itinerary-title {
            font-family: 'Press Start 2P';
            color: var(--neon-pink);
            margin-bottom: 20px;
        }

        .time-slot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px dashed var(--neon-blue);
        }

        .time-slot:last-child {
            border-bottom: none;
        }

        .time {
            font-weight: bold;
            color: var(--neon-blue);
            font-size: 1.2rem;
        }

        .activity {
            text-align: right;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Chatbot Section */
        .chatbot-container {
            margin-top: 50px;
            border: 4px solid var(--terminal-green);
            background-color: rgba(0, 0, 0, 0.85); /* Slightly transparent */
            padding: 2px;
            box-shadow: 0 0 20px var(--terminal-green);
            position: relative;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }

        .chatbot-header {
            background: var(--terminal-green);
            color: #000;
            font-family: 'Press Start 2P';
            padding: 10px;
            font-size: 0.8rem;
        }

        .chat-display {
            height: 300px;
            overflow-y: auto;
            padding: 20px;
            text-align: left;
            font-family: 'Orbitron', monospace;
            font-size: 1rem;
            color: var(--terminal-green);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            padding: 10px;
            border-radius: 5px;
            max-width: 85%;
        }

        .bot-msg {
            background: rgba(0, 50, 0, 0.5);
            border-left: 3px solid var(--terminal-green);
            align-self: flex-start;
            color: var(--terminal-green);
        }

        .user-msg {
            background: rgba(0, 0, 50, 0.5);
            border-right: 3px solid var(--neon-blue);
            color: var(--neon-blue);
            align-self: flex-end;
            text-align: right;
        }

        .chat-input-area {
            display: flex;
            border-top: 2px solid var(--terminal-green);
        }

        #user-input {
            flex: 1;
            background: rgba(0,0,0,0.5);
            border: none;
            color: var(--terminal-green);
            padding: 15px;
            font-family: 'Orbitron', monospace;
            outline: none;
        }

        #send-btn {
            background: var(--terminal-green);
            color: #000;
            border: none;
            padding: 0 20px;
            font-family: 'Press Start 2P';
            cursor: pointer;
            font-size: 0.8rem;
        }

        #send-btn:hover {
            background: #fff;
        }

        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .nav-btn { width: 100%; margin-bottom: 5px;}
        }

        /* TROLL IMAGE */
        #troll-img {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 300px;
            z-index: 10000;
            pointer-events: none;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #troll-img.show { transform: translate(-50%, -50%) scale(1); }
        #troll-img.fly-away {
            transition: all 1s ease-in;
            top: -200px; left: 120%; transform: rotate(720deg) scale(0.5);
        }

    </style>
</head>
<body>

<!-- 2. BOOT SCREEN HTML -->
<div id="boot-screen">
    <div class="boot-text">
        > SYSTEM BOOT SEQUENCE INITIATED...<br>
        > LOADING SKYWORLD ASSETS... [OK]<br>
        > ESTABLISHING SECURE CONNECTION... [OK]<br>
        > INITIALIZING NEURAL NETWORK... [OK]<br>
        > WELCOME PLAYER.
    </div>
</div>

<div class="bg-grid"></div>
<div class="scanlines"></div>
<div id="canvas-container"></div>

<div class="container">
    <header>
        <h1 class="hacker-text">SKYWORLD LOOTS</h1>
        <div class="subtitle hacker-text">LEVEL: GENTING HIGHLANDS // 11-12 DEC 2025</div>
        <div style="margin-top: 10px; color: #fff; font-size: 0.8rem;">HOSTS: JAYCE & SELINA</div>

        <nav>
            <a href="#" class="nav-btn hacker-text" style="border-color: var(--neon-pink); color: var(--neon-pink); box-shadow: 0 0 10px var(--neon-pink);">Home</a>
            <a href="scoreboard.html" class="nav-btn hacker-text">Scoreboard</a>
            <a href="gamerules.html" class="nav-btn hacker-text">Game Rules</a>
            <a href="themepark.html" class="nav-btn hacker-text">Theme Park</a>
            <a href="prize.html" class="nav-btn hacker-text">Prize Pools</a>
            <a href="wish.html" class="nav-btn hacker-text">Secret Santa</a>
            <a href="others.html" class="nav-btn hacker-text">Others</a>
        </nav>
        </header>

    <div class="itinerary-box">
        <h2 class="itinerary-title">MISSION LOG: DAY 1 (11 DEC)</h2>
        
        <div class="time-slot">
            <div class="time">07:00 AM</div>
            <div class="activity">Gather @ Loading Bay</div>
        </div>
        <div class="time-slot">
            <div class="time">07:30 AM</div>
            <div class="activity">Depart to Base (Genting)</div>
        </div>
        <div class="time-slot">
            <div class="time">09:00 AM</div>
            <div class="activity">Arrive First World Lobby</div>
        </div>
        <div class="time-slot">
            <div class="time">10:00 AM</div>
            <div class="activity">Enter SkyWorld Theme Park</div>
        </div>
        <div class="time-slot">
            <div class="time">12:00 PM</div>
            <div class="activity">Lunch @ Buck Café</div>
        </div>
        <div class="time-slot">
            <div class="time">05:00 PM</div>
            <div class="activity">Check-in Hotel</div>
        </div>
        <div class="time-slot">
            <div class="time">06:00 PM</div>
            <div class="activity">Gather & Dinner (Burger & Lobster)</div>
        </div>
    </div>

    <div class="chatbot-container">
        <div class="chatbot-header">
            NPC: JAYCE HOST [ONLINE]
        </div>
        <div class="chat-display" id="chat-display">
            <div class="message bot-msg">
        	Greetings, Player! I am AI Jayce.<br><br>
        	You can ask me info for Day 1 (11/12/2025).<br>
        	For example: Ask me where to gather for lunch.<br><br>
        	You can ask me in any language!
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="user-input" placeholder="Type command here..." onkeypress="handleEnter(event)">
            <button id="send-btn" onclick="sendMessage()">SEND</button>
        </div>
    </div>
</div>

<img id="troll-img" src="troll.png" alt="Troll Face">

<script>
    // =====================================================
    // 1. SYSTEM BOOT SCREEN LOGIC
    // =====================================================
    window.addEventListener('load', () => {
        setTimeout(() => {
            const bootScreen = document.getElementById('boot-screen');
            bootScreen.style.opacity = '0';
            setTimeout(() => {
                bootScreen.style.display = 'none';
            }, 800); // Wait for transition to finish
        }, 1500); // Show boot screen for 1.5 seconds
    });

    // =====================================================
    // 2. AUDIO SYSTEM (Synthesized Sounds)
    // =====================================================
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        // Ensure context is running (browsers suspend it by default)
        if (audioCtx.state === 'suspended') audioCtx.resume();
        
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        const now = audioCtx.currentTime;

        if (type === 'hover') {
            // High pitch chirp
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, now);
            oscillator.frequency.exponentialRampToValueAtTime(1200, now + 0.05);
            gainNode.gain.setValueAtTime(0.02, now); // Volume low
            gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.05);
            oscillator.start(now);
            oscillator.stop(now + 0.05);
        } 
        else if (type === 'click') {
            // Low pitch selection blip
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(300, now);
            oscillator.frequency.exponentialRampToValueAtTime(100, now + 0.1);
            gainNode.gain.setValueAtTime(0.05, now);
            gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
            oscillator.start(now);
            oscillator.stop(now + 0.1);
        }
    }

    // Attach sounds to all interactive elements
    document.querySelectorAll('a, button, .nav-btn, input').forEach(el => {
        el.addEventListener('mouseenter', () => playSound('hover'));
        el.addEventListener('click', () => playSound('click'));
    });

    // =====================================================
    // 3. HACKER TEXT SCRAMBLE EFFECT
    // =====================================================
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*";
    
    const hackerElements = document.querySelectorAll('.hacker-text');

    // 1. Memorize the correct text on load to prevent corruption
    hackerElements.forEach(element => {
        element.dataset.value = element.innerText; // Store original text in a data attribute
    });

    hackerElements.forEach(element => {
        element.addEventListener("mouseover", event => {  
            let iteration = 0;
            
            // ALWAYS read from the safe data-attribute, NEVER from innerText
            const originalText = element.dataset.value; 
            
            clearInterval(element.interval);

            element.interval = setInterval(() => {
                element.innerText = originalText
                    .split("")
                    .map((letter, index) => {
                        // If we are passed this index, show the REAL letter
                        if(index < iteration) {
                            return originalText[index];
                        }
                        // Otherwise show a random matrix character
                        return letters[Math.floor(Math.random() * letters.length)];
                    })
                    .join("");

                if(iteration >= originalText.length){ 
                    clearInterval(element.interval);
                    // Force the final result to be exact to fix any leftover artifacts
                    element.innerText = originalText;
                }
                
                iteration += 1 / 3;
            }, 30);
        });
    });

    // =====================================================
    // 4. 3D NEURAL NETWORK VISUALIZATION (Three.js)
    // =====================================================
    const initThreeJS = () => {
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050505, 0.002);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 50;

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        const geometry = new THREE.BufferGeometry();
        const particleCount = 200; 
        const posArray = new Float32Array(particleCount * 3);

        for(let i = 0; i < particleCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 100;
        }

        geometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

        const material = new THREE.PointsMaterial({
            size: 0.7,
            color: 0x00ffff, 
            transparent: true,
            opacity: 0.8,
        });

        const lineMaterial = new THREE.LineBasicMaterial({
            color: 0xbc13fe, 
            transparent: true,
            opacity: 0.3
        });

        const particlesMesh = new THREE.Points(geometry, material);
        scene.add(particlesMesh);

        let mouseX = 0;
        let mouseY = 0;
        let targetX = 0;
        let targetY = 0;
        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        document.addEventListener('mousemove', (event) => {
            mouseX = (event.clientX - windowHalfX);
            mouseY = (event.clientY - windowHalfY);
        });

        const clock = new THREE.Clock();

        const animate = () => {
            targetX = mouseX * 0.001;
            targetY = mouseY * 0.001;

            const elapsedTime = clock.getElapsedTime();

            particlesMesh.rotation.y = .1 * elapsedTime;
            particlesMesh.rotation.x += .05 * (targetY - particlesMesh.rotation.x);
            particlesMesh.rotation.y += .05 * (targetX - particlesMesh.rotation.y);

            const lineGeometry = new THREE.BufferGeometry();
            const linePositions = [];
            const positions = particlesMesh.geometry.attributes.position.array;

            for (let i = 0; i < particleCount; i++) {
                const x1 = positions[i * 3];
                const y1 = positions[i * 3 + 1];
                const z1 = positions[i * 3 + 2];

                for (let j = i + 1; j < particleCount; j++) {
                    const x2 = positions[j * 3];
                    const y2 = positions[j * 3 + 1];
                    const z2 = positions[j * 3 + 2];

                    const dist = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2) + Math.pow(z1 - z2, 2));

                    if (dist < 15) {
                        linePositions.push(x1, y1, z1);
                        linePositions.push(x2, y2, z2);
                    }
                }
            }

            lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(linePositions, 3));
            
            const oldLines = scene.getObjectByName('networkLines');
            if (oldLines) scene.remove(oldLines);

            const lines = new THREE.LineSegments(lineGeometry, lineMaterial);
            lines.name = 'networkLines';
            lines.rotation.copy(particlesMesh.rotation);
            scene.add(lines);

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        };

        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    };

    initThreeJS();


    // =====================================================
    // 5. CHATBOT LOGIC (Gemini)
    // =====================================================
    const API_KEYS = [
        { A: "AIzaSyADV6D3Lzl5piE", B: "MdcTg2dcj30H-A-rEyP8" }, 
        { A: "AIzaSyDNVOG5jV1z5l", B: "1ghdAy2UFCBuxaoTLgh2Y" }, 
        { A: "AIzaSyAflXoNsYmyjSa", B: "xomoEps2av4J5jGiPR7w" }, 
        { A: "AIzaSyAp2sKOhs9R7HE", B: "aA1xHMwq--_S2aFdvf2c" }, 
        { A: "AIzaSyAO3eSo5g9fiUb", B: "dbcJsoNPGiBLNiIKX5zk" }, 
        { A: "AIzaSyBQsnuHXoh03F", B: "OmIQX-Z79dQ8dKrdp6KTk" }  
    ];

    function buildKey(obj) { return obj.A + obj.B; }

    async function callGemini(key, prompt) {
        return fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${key}`,
            {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            }
        );
    }

    const chatDisplay = document.getElementById('chat-display');
    const userInput = document.getElementById('user-input');

    const eventContext = `
    You are a helpful, clear, and direct automated assistant named "Jayce Host".
    Your purpose is to assist participants of the "SkyWorld Loots" company trip with their schedule.
    
    EVENT DETAILS:
    Date: 11 Dec 2025 to 12 Dec 2025. Location: Genting Highlands. Hosts: Jayce and Selina. Theme: SkyWorld Loots (Neon/Arcade).

    LOGISTICS RULES (DAY 1 - 11/12/2025):
    - 7:00 AM: Gather at Office Loading Bay, Load backpacks + Secret Santa gifts into Mr. Kelvin's car. 
    - LUGGAGE RULE: Luggage should have been put in Ying's car on 9/12/2025. Ying's car isn't at office on 11/12.
    - BACKPACK RULE: Once loaded in car, NO ACCESS until 5:00 PM (Hotel Check-in).
    - 7:30 AM: Depart.
    - 9:00 AM: Arrive First World Lobby. Walk to Theme Park.
    - BRIEFING: By Jayce and Selina at entrance.
    - 10:00 AM: Enter Theme Park. Group Photo.
    - LOCKERS: Located in Andromeda Base. Rent one immediately.
    - 10:30 AM - 12:00 PM: Free & Easy.
    - 12:00 PM: Gather at lockers, walk to Buck Café.
    - LUNCH: Allowance RM35 was given on 10/12/2025.
    - 12:50 PM: Mini Game "Animal Tag".
    - 1:00 PM - 4:00 PM: Free & Easy.
    - 4:00 PM: Gather at Central Park Garden.
    - 4:00 PM - 4:30 PM: "Pair Up" Game.
    - 4:30 PM: Exit park. Go to carpack to collect backpacks/luggage.
    - 5:00 PM: Check-in First World Hotel.
    - 6:00 PM: Gather at Lobby. Dinner at Burger & Lobster.

    GAMES: 6 Total (Hand Sign, Pair up, animal Tag, Photo Target, Creative Photo, Question).
    SECRET SANTA: Exchange happens during Annual Dinner.

    YOUR BEHAVIOR:
    1. VERY SHORT answers (max 3 sentences).
    2. Only answer Day 1 Itinerary questions.
    3. If asked something else: say you can only provide Day 1 details. 
    
    CRITICAL RULE FOR TROLLS/FUNNY/WEIRD QUESTIONS:
    4. If the user asks something dumb, playful, trolling, or weird (e.g. "Can I fly?"):
       - Answer them humorously or sarcastically.
       - YOU MUST END YOUR RESPONSE WITH THIS EXACT TAG: [[TROLL_DETECTED]]
       
    5. Compare with current Malaysia time when answering.
    `;

    function handleEnter(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    }

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        appendMessage(text, 'user-msg');
        userInput.value = '';

        const now = new Date();
        const malaysiaTime = now.toLocaleString("en-US", { timeZone: "Asia/Kuala_Lumpur" });

        const prompt = `
        ${eventContext}
        CURRENT USER TIME (Malaysia): ${malaysiaTime}
        USER QUESTION: ${text}
        Based on the CURRENT USER TIME, advise them on their status in the timeline if relevant.
        `;

        const loadingDiv = document.createElement('div');
        loadingDiv.className = 'message bot-msg';
        loadingDiv.textContent = 'Processing request...';
        loadingDiv.id = 'loading-msg';
        chatDisplay.appendChild(loadingDiv);
        chatDisplay.scrollTop = chatDisplay.scrollHeight;

        let finalResponse = null;

        for (let i = 0; i < API_KEYS.length; i++) {
            const keyObj = API_KEYS[i];
            if (!keyObj.A || !keyObj.B) continue;
            const fullKey = buildKey(keyObj);

            try {
                let response = await callGemini(fullKey, prompt);
                let data = null;
                try { data = await response.clone().json(); } catch (e) { data = null; }
                if (response.ok && data && !data.error) {
                    finalResponse = data;
                    break;
                }
            } catch (err) {}
        }

        document.getElementById('loading-msg')?.remove();

        if (finalResponse?.candidates?.[0]?.content) {
            let reply = finalResponse.candidates[0].content.parts[0].text;
            if (reply.includes('[[TROLL_DETECTED]]')) {
                reply = reply.replace('[[TROLL_DETECTED]]', '');
                triggerTroll();
            }
            appendMessage(reply, 'bot-msg');
        } else {
            appendMessage("SYSTEM ERROR: No functioning API key detected.", 'bot-msg');
        }
    }

    function appendMessage(text, className) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `message ${className}`;
        msgDiv.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
        chatDisplay.appendChild(msgDiv);
        chatDisplay.scrollTop = chatDisplay.scrollHeight;
    }

    function triggerTroll() {
        const img = document.getElementById('troll-img');
        img.className = ''; 
        requestAnimationFrame(() => { img.classList.add('show'); });
        setTimeout(() => {
            img.classList.remove('show');
            img.classList.add('fly-away');
        }, 2000); 
    }
</script>

</body>
</html>
